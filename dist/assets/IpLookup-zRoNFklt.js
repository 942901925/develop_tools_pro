import{r as s,c as e,k as a,l as o,m as t,n as l,t as n,u as i,C as u,D as r,F as p,q as c,j as d}from"./vendor-Bj4vQ21v.js";import{u as v}from"./index-D0OvHsGD.js";import{s as g,G as y}from"./ui-a1y1iJBQ.js";const m=new class{constructor(){this.queue=[],this.active=0,this.maxConcurrent=2,this.timeout=1e4}async request(s,e={}){return new Promise((a,o)=>{const t={...e,signal:AbortSignal.timeout(this.timeout),priority:"low"};this.queue.push({url:s,options:t,resolve:a,reject:o,timestamp:Date.now()}),this.process()})}async process(){if(this.active>=this.maxConcurrent||0===this.queue.length)return;this.active++;const{url:s,options:e,resolve:a,reject:o}=this.queue.shift();try{const o=await fetch(s,e);if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);a(o)}catch(t){o(t)}finally{this.active--,this.process()}}cleanup(){const s=Date.now();this.queue=this.queue.filter(e=>s-e.timestamp<3e4)}};setInterval(()=>{m.cleanup()},6e4);const k=(s,e={})=>m.request(s,e),h={class:"space-y-6"},x={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},b={class:"space-y-4"},f={class:"text-lg font-semibold text-gray-900"},w={class:"space-y-3"},L={class:"block text-sm font-medium text-gray-700"},I={class:"flex space-x-2"},$=["placeholder"],q=["disabled"],C=["disabled"],j={key:0,class:"space-y-3"},S={class:"font-medium text-gray-900"},P={class:"space-y-2"},T=["onClick"],A={class:"space-y-4"},_={class:"text-lg font-semibold text-gray-900"},D={key:0,class:"space-y-4"},H={class:"bg-white border border-gray-200 rounded-lg p-4"},N={class:"font-medium text-gray-900 mb-3"},O={class:"grid grid-cols-2 gap-3 text-sm"},z={class:"text-gray-500"},E={class:"ml-2 font-mono"},J={class:"text-gray-500"},U={class:"ml-2"},F={class:"text-gray-500"},G={class:"ml-2"},M={class:"text-gray-500"},R={class:"ml-2 font-mono"},V={class:"bg-white border border-gray-200 rounded-lg p-4"},B={class:"font-medium text-gray-900 mb-3"},K={class:"grid grid-cols-2 gap-3 text-sm"},Q={class:"text-gray-500"},W={class:"ml-2"},X={class:"text-gray-500"},Y={class:"ml-2"},Z={class:"text-gray-500"},ss={class:"ml-2"},es={class:"text-gray-500"},as={class:"ml-2"},os={class:"col-span-2"},ts={class:"text-gray-500"},ls={class:"ml-2 font-mono"},ns={class:"bg-white border border-gray-200 rounded-lg p-4"},is={class:"font-medium text-gray-900 mb-3"},us={class:"grid grid-cols-2 gap-3 text-sm"},rs={class:"ml-2"},ps={class:"ml-2 font-mono"},cs={class:"text-gray-500"},ds={class:"ml-2"},vs={class:"ml-2"},gs={class:"flex space-x-2"},ys=["disabled"],ms={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ks={class:"flex items-center"},hs={class:"text-red-700"},xs={key:2,class:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center"},bs={class:"text-gray-500"},fs={__name:"IpLookup",setup(m){const{t:fs}=v(),ws=s(""),Ls=s(null),Is=s(""),$s=s(!1),qs=s([]),Cs=e(()=>/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(ws.value)),js=async()=>{$s.value=!0,Is.value="";try{const s=await k("https://api.ipify.org?format=json"),e=await s.json();ws.value=e.ip}catch(s){Is.value="获取本机 IP 失败"}finally{$s.value=!1}},Ss=async()=>{if(Cs.value){$s.value=!0,Is.value="",Ls.value=null;try{const s=await k(`https://ipapi.co/${ws.value}/json/`),e=await s.json();if(e.error)throw new Error(e.reason||"查询失败");Ls.value=e,Ps({ip:ws.value,location:`${e.city||""} ${e.region||""} ${e.country||""}`.trim()})}catch(s){Is.value=s.message||"查询 IP 信息失败"}finally{$s.value=!1}}},Ps=s=>{qs.value=qs.value.filter(e=>e.ip!==s.ip),qs.value.unshift(s),qs.value.length>10&&(qs.value=qs.value.slice(0,10)),localStorage.setItem("ip-lookup-history",JSON.stringify(qs.value))},Ts=()=>{qs.value=[],localStorage.removeItem("ip-lookup-history")},As=()=>{if(!Ls.value)return;const s=`IP: ${Ls.value.ip}\n国家: ${Ls.value.country||"未知"}\n地区: ${Ls.value.region||"未知"}\n城市: ${Ls.value.city||"未知"}\nISP: ${Ls.value.org||"未知"}\n坐标: ${Ls.value.loc||"未知"}`;navigator.clipboard.writeText(s).then(()=>{alert("IP 信息已复制到剪贴板")}).catch(()=>{alert("复制失败")})},_s=()=>{var s;if(!(null==(s=Ls.value)?void 0:s.loc))return;const[e,a]=Ls.value.loc.split(","),o=`https://www.google.com/maps?q=${e},${a}`;window.open(o,"_blank")};return(()=>{try{const s=localStorage.getItem("ip-lookup-history");s&&(qs.value=JSON.parse(s))}catch(s){}})(),(s,e)=>(o(),a("div",h,[t("div",x,[t("div",b,[t("h3",f,n(i(fs)("ipLookup.title")),1),t("div",w,[t("label",L,n(i(fs)("ipLookup.ipAddress")),1),t("div",I,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>ws.value=s),type:"text",placeholder:i(fs)("ipLookup.enterIpAddress"),class:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,$),[[r,ws.value]]),t("button",{onClick:js,disabled:$s.value,class:"btn-secondary whitespace-nowrap"},n($s.value?i(fs)("ipLookup.querying"):i(fs)("ipLookup.myIp")),9,q)])]),t("button",{onClick:Ss,disabled:!Cs.value||$s.value,class:"btn-primary w-full"},n($s.value?i(fs)("ipLookup.querying"):i(fs)("ipLookup.queryIpInfo")),9,C),qs.value.length>0?(o(),a("div",j,[t("h4",S,n(i(fs)("ipLookup.searchHistory")),1),t("div",P,[(o(!0),a(p,null,c(qs.value.slice(0,5),(s,e)=>(o(),a("button",{key:e,onClick:e=>(s=>{ws.value=s.ip})(s),class:"w-full text-left px-3 py-2 bg-gray-50 hover:bg-gray-100 rounded-md text-sm text-gray-700 transition-colors"},n(s.ip)+" - "+n(s.location||i(fs)("ipLookup.unknownLocation")),9,T))),128))]),t("button",{onClick:Ts,class:"text-sm text-red-600 hover:text-red-700"},n(i(fs)("ipLookup.clearHistory")),1)])):l("",!0)]),t("div",A,[t("h3",_,n(i(fs)("ipLookup.queryResult")),1),Ls.value?(o(),a("div",D,[t("div",H,[t("h4",N,n(i(fs)("ipLookup.basicInfo")),1),t("div",O,[t("div",null,[t("span",z,n(i(fs)("ipLookup.ipAddress"))+":",1),t("span",E,n(Ls.value.ip),1)]),t("div",null,[t("span",J,n(i(fs)("ipLookup.type"))+":",1),t("span",U,n(Ls.value.type||i(fs)("ipLookup.unknown")),1)]),t("div",null,[t("span",F,n(i(fs)("ipLookup.version"))+":",1),t("span",G,n(Ls.value.version||i(fs)("ipLookup.unknown")),1)]),t("div",null,[t("span",M,n(i(fs)("ipLookup.hostname"))+":",1),t("span",R,n(Ls.value.hostname||i(fs)("ipLookup.none")),1)])])]),t("div",V,[t("h4",B,n(i(fs)("ipLookup.geoLocation")),1),t("div",K,[t("div",null,[t("span",Q,n(i(fs)("ipLookup.country"))+":",1),t("span",W,n(Ls.value.country||i(fs)("ipLookup.unknown")),1)]),t("div",null,[t("span",X,n(i(fs)("ipLookup.region"))+":",1),t("span",Y,n(Ls.value.region||i(fs)("ipLookup.unknown")),1)]),t("div",null,[t("span",Z,n(i(fs)("ipLookup.city"))+":",1),t("span",ss,n(Ls.value.city||i(fs)("ipLookup.unknown")),1)]),t("div",null,[t("span",es,n(i(fs)("ipLookup.postal"))+":",1),t("span",as,n(Ls.value.postal||i(fs)("ipLookup.unknown")),1)]),t("div",os,[t("span",ts,n(i(fs)("ipLookup.coordinates"))+":",1),t("span",ls,n(Ls.value.loc||i(fs)("ipLookup.unknown")),1)])])]),t("div",ns,[t("h4",is,n(i(fs)("ipLookup.networkInfo")),1),t("div",us,[t("div",null,[e[1]||(e[1]=t("span",{class:"text-gray-500"},"ISP:",-1)),t("span",rs,n(Ls.value.org||i(fs)("ipLookup.unknown")),1)]),t("div",null,[e[2]||(e[2]=t("span",{class:"text-gray-500"},"ASN:",-1)),t("span",ps,n(Ls.value.asn||i(fs)("ipLookup.unknown")),1)]),t("div",null,[t("span",cs,n(i(fs)("ipLookup.timezone"))+":",1),t("span",ds,n(Ls.value.timezone||i(fs)("ipLookup.unknown")),1)]),t("div",null,[e[3]||(e[3]=t("span",{class:"text-gray-500"},"UTC:",-1)),t("span",vs,n(Ls.value.utc_offset||i(fs)("ipLookup.unknown")),1)])])]),t("div",gs,[t("button",{onClick:As,class:"btn-secondary flex-1"},n(i(fs)("ipLookup.copyInfo")),1),t("button",{onClick:_s,disabled:!Ls.value.loc,class:"btn-primary flex-1"},n(i(fs)("ipLookup.viewOnMap")),9,ys)])])):Is.value?(o(),a("div",ms,[t("div",ks,[d(i(g),{class:"w-5 h-5 text-red-500 mr-2"}),t("span",hs,n(Is.value),1)])])):(o(),a("div",xs,[d(i(y),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t("p",bs,n(i(fs)("ipLookup.enterIpToStart")),1)]))])])]))}};export{fs as default};

import{r as e,k as a,l,m as t,n as s,p as r,R as o,j as n,u,C as i,N as d,O as c,t as p,D as g}from"./vendor-Cf-Dxv3i.js";import{I as v}from"./ui-D-c3Ifvx.js";const m={class:"space-y-6"},b={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},y={class:"space-y-4"},h={class:"space-y-4"},f={class:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center"},x={key:0,class:"space-y-4"},w={class:"space-y-3"},k={key:0},j={class:"block text-sm font-medium text-gray-700 mb-1"},C={class:"block text-sm font-medium text-gray-700 mb-1"},M=["disabled"],B={class:"space-y-4"},D={key:0,class:"space-y-4"},U={class:"bg-gray-50 rounded-lg p-4"},I={class:"text-sm text-gray-600 space-y-1"},F={class:"mt-3"},R=["src"],z={key:0,class:"bg-green-50 rounded-lg p-4"},G={class:"text-sm text-gray-600 space-y-1"},P={class:"mt-3"},_=["src"],E={__name:"ImageConverter",setup(E){const L=e(null),V=e(null),W=e(null),$=e(null),A=e(!1),N=e(!1),J=e("jpeg"),K=e(90),O=e(100),T=e=>{const a=e.target.files[0];a&&a.type.startsWith("image/")&&H(a)},q=e=>{A.value=!1;const a=e.dataTransfer.files[0];a&&a.type.startsWith("image/")&&H(a)},H=e=>{V.value=e;const a=new FileReader;a.onload=e=>{const a=new v;a.onload=()=>{W.value={src:e.target.result,width:a.width,height:a.height}},a.src=e.target.result},a.readAsDataURL(e)},Q=()=>{if(!W.value)return;N.value=!0;const e=document.createElement("canvas"),a=e.getContext("2d"),l=new v;l.onload=()=>{const t=Math.round(l.width*O.value/100),s=Math.round(l.height*O.value/100);e.width=t,e.height=s,a.drawImage(l,0,0,t,s);const r=S(J.value),o="jpeg"===J.value?K.value/100:void 0;e.toBlob(e=>{const a=new FileReader;a.onload=a=>{$.value={src:a.target.result,width:t,height:s,size:e.size},N.value=!1},a.readAsDataURL(e)},r,o)},l.src=W.value.src},S=e=>({jpeg:"image/jpeg",png:"image/png",webp:"image/webp",bmp:"image/bmp",gif:"image/gif"}[e]||"image/jpeg"),X=()=>{if(!$.value)return;const e="jpeg"===J.value?"jpg":J.value,a=document.createElement("a");a.download=`converted_${Date.now()}.${e}`,a.href=$.value.src,a.click()},Y=e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]};return(e,E)=>{return l(),a("div",m,[t("div",b,[t("div",y,[E[10]||(E[10]=t("h3",{class:"text-lg font-semibold text-gray-900"},"上传图片",-1)),t("div",{onDrop:q,onDragover:E[1]||(E[1]=o(()=>{},["prevent"])),onDragenter:E[2]||(E[2]=o(()=>{},["prevent"])),class:r(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors cursor-pointer",{"border-blue-500 bg-blue-50":A.value}])},[t("input",{ref_key:"fileInput",ref:L,type:"file",accept:"image/*",onChange:T,class:"hidden"},null,544),t("div",h,[t("div",f,[n(u(v),{class:"w-8 h-8 text-gray-400"})]),E[6]||(E[6]=t("div",null,[t("p",{class:"text-lg font-medium text-gray-900"},"拖拽图片到此处"),t("p",{class:"text-sm text-gray-500"},"或点击选择文件")],-1)),t("button",{onClick:E[0]||(E[0]=a=>e.$refs.fileInput.click()),class:"btn-primary"}," 选择图片 ")])],34),V.value?(l(),a("div",x,[E[9]||(E[9]=t("h4",{class:"font-medium text-gray-900"},"转换设置",-1)),t("div",w,[t("div",null,[E[8]||(E[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"目标格式",-1)),i(t("select",{"onUpdate:modelValue":E[3]||(E[3]=e=>J.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...E[7]||(E[7]=[c('<option value="jpeg">JPEG</option><option value="png">PNG</option><option value="webp">WebP</option><option value="bmp">BMP</option><option value="gif">GIF</option>',5)])],512),[[d,J.value]])]),"jpeg"===J.value?(l(),a("div",k,[t("label",j,"质量 ("+p(K.value)+"%)",1),i(t("input",{"onUpdate:modelValue":E[4]||(E[4]=e=>K.value=e),type:"range",min:"10",max:"100",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,512),[[g,K.value]])])):s("",!0),t("div",null,[t("label",C,"缩放比例 ("+p(O.value)+"%)",1),i(t("input",{"onUpdate:modelValue":E[5]||(E[5]=e=>O.value=e),type:"range",min:"10",max:"200",step:"10",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,512),[[g,O.value]])])]),t("button",{onClick:Q,disabled:N.value,class:"btn-primary w-full"},p(N.value?"转换中...":"开始转换"),9,M)])):s("",!0)]),t("div",B,[E[13]||(E[13]=t("h3",{class:"text-lg font-semibold text-gray-900"},"转换结果",-1)),W.value?(l(),a("div",D,[t("div",U,[E[11]||(E[11]=t("h4",{class:"font-medium text-gray-900 mb-2"},"原图信息",-1)),t("div",I,[t("p",null,"文件名: "+p(V.value.name),1),t("p",null,"格式: "+p((H=V.value.name,H.split(".").pop().toLowerCase()).toUpperCase()),1),t("p",null,"大小: "+p(Y(V.value.size)),1),t("p",null,"尺寸: "+p(W.value.width)+" × "+p(W.value.height),1)]),t("div",F,[t("img",{src:W.value.src,class:"max-w-full h-auto rounded border"},null,8,R)])]),$.value?(l(),a("div",z,[E[12]||(E[12]=t("h4",{class:"font-medium text-gray-900 mb-2"},"转换后信息",-1)),t("div",G,[t("p",null,"格式: "+p(J.value.toUpperCase()),1),t("p",null,"大小: "+p(Y($.value.size)),1),t("p",null,"尺寸: "+p($.value.width)+" × "+p($.value.height),1)]),t("div",P,[t("img",{src:$.value.src,class:"max-w-full h-auto rounded border"},null,8,_)]),t("div",{class:"mt-3 flex space-x-2"},[t("button",{onClick:X,class:"btn-primary flex-1"}," 下载转换图片 ")])])):s("",!0)])):s("",!0)])])]);var H}}};export{E as default};

import{r as e,c as l,k as s,l as t,m as a,n,z as o,N as r,t as c,p as u,O as d,F as i,q as g,A as v,J as p,K as x}from"./vendor-BAdfJYHu.js";const m={class:"space-y-6"},b={class:"bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg"},y={class:"space-y-4"},h={class:"relative"},f=["type"],w={key:0,class:"space-y-4"},k={class:"space-y-2"},M={class:"flex justify-between items-center"},j={class:"w-full bg-gray-200 rounded-full h-2"},z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},C={class:"space-y-3"},A={class:"space-y-2"},U={class:"flex justify-between"},V={class:"font-mono"},$={class:"flex justify-between"},Z={class:"font-mono"},q={class:"flex justify-between"},S={class:"font-mono"},T={class:"flex justify-between"},_={class:"font-mono"},F={class:"flex justify-between"},J={class:"font-mono"},K={class:"space-y-3"},N={class:"space-y-2"},O={class:"flex justify-between"},P={class:"font-mono"},B={class:"flex justify-between"},D={class:"font-mono text-sm"},E={class:"flex justify-between"},G={class:"font-mono"},H={key:0,class:"space-y-2"},I={class:"space-y-1"},L={class:"space-y-4"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},R={class:"space-y-4"},W={class:"text-center text-sm text-gray-600"},X={class:"space-y-2"},Y={class:"flex items-center"},ee={class:"flex items-center"},le={class:"flex items-center"},se={class:"flex items-center"},te={class:"space-y-4"},ae={class:"p-3 bg-gray-100 rounded-lg font-mono text-sm break-all"},ne={class:"space-y-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},re=["onClick"],ce={class:"font-mono text-sm"},ue={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},de={class:"bg-green-50 p-4 rounded-lg text-center"},ie={class:"text-2xl font-bold text-green-600"},ge={class:"bg-blue-50 p-4 rounded-lg text-center"},ve={class:"text-2xl font-bold text-blue-600"},pe={class:"bg-purple-50 p-4 rounded-lg text-center"},xe={class:"text-2xl font-bold text-purple-600"},me={class:"bg-orange-50 p-4 rounded-lg text-center"},be={class:"text-2xl font-bold text-orange-600"},ye={__name:"PasswordStrength",setup(ye){const he=e(""),fe=e(!1),we=e(null),ke=e(12),Me=e({lowercase:!0,uppercase:!0,numbers:!0,special:!0}),je=e(""),ze=e(["password","123456","123456789","qwerty","abc123","password123","admin","letmein","welcome","monkey","1234567890","password1","qwerty123","dragon","master"]),Ce=l(()=>{if(!we.value)return"无";const e=we.value.score;return e<20?"很弱":e<40?"弱":e<60?"中等":e<80?"强":"很强"}),Ae=l(()=>{const e=Ce.value;return"很弱"===e?"text-red-600":"弱"===e?"text-orange-600":"中等"===e?"text-yellow-600":"强"===e?"text-blue-600":"text-green-600"}),Ue=l(()=>{const e=Ce.value;return"很弱"===e?"bg-red-500":"弱"===e?"bg-orange-500":"中等"===e?"bg-yellow-500":"强"===e?"bg-blue-500":"bg-green-500"}),Ve=l(()=>we.value?Math.min(100,we.value.score):0),$e=()=>{if(!he.value)return;const e=he.value;let l=0;const s=[];e.length<8?s.push("密码长度至少8位"):e.length>=12?l+=20:l+=10;const t=/[a-z]/.test(e),a=/[A-Z]/.test(e),n=/[0-9]/.test(e),o=/[^a-zA-Z0-9]/.test(e);t?l+=10:s.push("包含小写字母"),a?l+=10:s.push("包含大写字母"),n?l+=10:s.push("包含数字"),o?l+=15:s.push("包含特殊字符");new Set(e).size>=.8*e.length?l+=10:s.push("使用更多不同的字符"),/(.)\1{2,}/.test(e)&&(l-=10,s.push("避免重复字符")),/123|abc|qwe/i.test(e)&&(l-=5,s.push("避免连续字符"));let r=0;t&&(r+=26),a&&(r+=26),n&&(r+=10),o&&(r+=32);const c=Math.log2(Math.pow(r,e.length)),u=Ze(c);we.value={length:e.length,lowercase:(e.match(/[a-z]/g)||[]).length,uppercase:(e.match(/[A-Z]/g)||[]).length,numbers:(e.match(/[0-9]/g)||[]).length,specialChars:(e.match(/[^a-zA-Z0-9]/g)||[]).length,score:Math.max(0,Math.min(100,l)),entropy:Math.round(10*c)/10,crackTime:u,charsetSize:r,suggestions:s}},Ze=e=>{const l=Math.pow(2,e)/1e9;return l<60?`${Math.round(l)}秒`:l<3600?`${Math.round(l/60)}分钟`:l<86400?`${Math.round(l/3600)}小时`:l<31536e3?`${Math.round(l/86400)}天`:`${Math.round(l/31536e3)}年`},qe=()=>{let e="";if(Me.value.lowercase&&(e+="abcdefghijklmnopqrstuvwxyz"),Me.value.uppercase&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),Me.value.numbers&&(e+="0123456789"),Me.value.special&&(e+="!@#$%^&*()_+-=[]{}|;:,.<>?"),0===e.length)return void alert("请至少选择一种字符类型");let l="";for(let s=0;s<ke.value;s++)l+=e.charAt(Math.floor(Math.random()*e.length));je.value=l},Se=()=>{fe.value=!fe.value},Te=()=>{he.value="",we.value=null},_e=async()=>{try{await navigator.clipboard.writeText(je.value)}catch(e){console.error("复制失败:",e)}};return(e,l)=>(t(),s("div",m,[a("div",b,[l[7]||(l[7]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"密码强度检测器",-1)),a("div",y,[a("div",null,[l[6]||(l[6]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"密码输入",-1)),a("div",h,[o(a("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>he.value=e),type:fe.value?"text":"password",placeholder:"输入要检测的密码",class:"w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},null,8,f),[[r,he.value]]),a("button",{onClick:Se,class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"},c(fe.value?"👁️":"👁️‍🗨️"),1)])]),a("div",{class:"flex space-x-2"},[a("button",{onClick:$e,class:"flex-1 px-4 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"}," 分析密码 "),a("button",{onClick:Te,class:"px-4 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"}," 清空 ")])])]),we.value?(t(),s("div",w,[l[20]||(l[20]=a("h3",{class:"text-lg font-semibold text-gray-900"},"密码强度分析",-1)),a("div",k,[a("div",M,[l[8]||(l[8]=a("span",{class:"text-sm font-medium text-gray-700"},"强度等级",-1)),a("span",{class:u([Ae.value,"text-lg font-bold"])},c(Ce.value),3)]),a("div",j,[a("div",{class:u(["h-2 rounded-full transition-all duration-500",Ue.value]),style:d({width:Ve.value+"%"})},null,6)])]),a("div",z,[a("div",C,[l[14]||(l[14]=a("h4",{class:"text-md font-semibold text-gray-900"},"字符分析",-1)),a("div",A,[a("div",U,[l[9]||(l[9]=a("span",null,"长度",-1)),a("span",V,c(we.value.length),1)]),a("div",$,[l[10]||(l[10]=a("span",null,"小写字母",-1)),a("span",Z,c(we.value.lowercase),1)]),a("div",q,[l[11]||(l[11]=a("span",null,"大写字母",-1)),a("span",S,c(we.value.uppercase),1)]),a("div",T,[l[12]||(l[12]=a("span",null,"数字",-1)),a("span",_,c(we.value.numbers),1)]),a("div",F,[l[13]||(l[13]=a("span",null,"特殊字符",-1)),a("span",J,c(we.value.specialChars),1)])])]),a("div",K,[l[18]||(l[18]=a("h4",{class:"text-md font-semibold text-gray-900"},"安全指标",-1)),a("div",N,[a("div",O,[l[15]||(l[15]=a("span",null,"熵值",-1)),a("span",P,c(we.value.entropy),1)]),a("div",B,[l[16]||(l[16]=a("span",null,"破解时间",-1)),a("span",D,c(we.value.crackTime),1)]),a("div",E,[l[17]||(l[17]=a("span",null,"字符集大小",-1)),a("span",G,c(we.value.charsetSize),1)])])])]),we.value.suggestions.length>0?(t(),s("div",H,[l[19]||(l[19]=a("h4",{class:"text-md font-semibold text-gray-900"},"改进建议",-1)),a("div",I,[(t(!0),s(i,null,g(we.value.suggestions,e=>(t(),s("div",{key:e,class:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded"}," • "+c(e),1))),128))])])):n("",!0)])):n("",!0),a("div",L,[l[28]||(l[28]=a("h3",{class:"text-lg font-semibold text-gray-900"},"密码生成器",-1)),a("div",Q,[a("div",R,[a("div",null,[l[21]||(l[21]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"密码长度",-1)),o(a("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>ke.value=e),type:"range",min:"8",max:"64",class:"w-full"},null,512),[[v,ke.value,void 0,{number:!0}]]),a("div",W,c(ke.value)+" 字符",1)]),a("div",null,[l[26]||(l[26]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"包含字符",-1)),a("div",X,[a("label",Y,[o(a("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>Me.value.lowercase=e),type:"checkbox",class:"mr-2"},null,512),[[x,Me.value.lowercase]]),l[22]||(l[22]=p(" 小写字母 (a-z) ",-1))]),a("label",ee,[o(a("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>Me.value.uppercase=e),type:"checkbox",class:"mr-2"},null,512),[[x,Me.value.uppercase]]),l[23]||(l[23]=p(" 大写字母 (A-Z) ",-1))]),a("label",le,[o(a("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>Me.value.numbers=e),type:"checkbox",class:"mr-2"},null,512),[[x,Me.value.numbers]]),l[24]||(l[24]=p(" 数字 (0-9) ",-1))]),a("label",se,[o(a("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>Me.value.special=e),type:"checkbox",class:"mr-2"},null,512),[[x,Me.value.special]]),l[25]||(l[25]=p(" 特殊字符 (!@#$%^&*) ",-1))])])])]),a("div",te,[a("div",null,[l[27]||(l[27]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"生成的密码",-1)),a("div",ae,c(je.value),1)]),a("div",{class:"flex space-x-2"},[a("button",{onClick:qe,class:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"}," 生成密码 "),a("button",{onClick:_e,class:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"}," 复制 ")])])])]),a("div",ne,[l[29]||(l[29]=a("h3",{class:"text-lg font-semibold text-gray-900"},"常用密码检测",-1)),a("div",oe,[(t(!0),s(i,null,g(ze.value,e=>(t(),s("div",{key:e,class:"p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:l=>{return s=e,he.value=s,void $e();var s}},[a("div",ce,c(e),1)],8,re))),128))])]),a("div",ue,[a("div",de,[a("div",ie,c(he.value.length),1),l[30]||(l[30]=a("div",{class:"text-sm text-gray-600"},"密码长度",-1))]),a("div",ge,[a("div",ve,c(we.value?we.value.score:0),1),l[31]||(l[31]=a("div",{class:"text-sm text-gray-600"},"强度分数",-1))]),a("div",pe,[a("div",xe,c(we.value?we.value.entropy:0),1),l[32]||(l[32]=a("div",{class:"text-sm text-gray-600"},"熵值",-1))]),a("div",me,[a("div",be,c(Ce.value),1),l[33]||(l[33]=a("div",{class:"text-sm text-gray-600"},"强度等级",-1))])])]))}};export{ye as default};

import{r as e,k as a,l,m as t,n as s,p as r,P as o,j as n,u,z as i,L as d,M as c,t as p,A as g}from"./vendor-BAdfJYHu.js";import{I as v}from"./ui-AB4YetZ5.js";const m={class:"space-y-6"},b={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},y={class:"space-y-4"},h={class:"space-y-4"},f={class:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center"},x={key:0,class:"space-y-4"},w={class:"space-y-3"},k={key:0},j={class:"block text-sm font-medium text-gray-700 mb-1"},C={class:"block text-sm font-medium text-gray-700 mb-1"},M=["disabled"],B={class:"space-y-4"},U={key:0,class:"space-y-4"},D={class:"bg-gray-50 rounded-lg p-4"},I={class:"text-sm text-gray-600 space-y-1"},z={class:"mt-3"},F=["src"],P={key:0,class:"bg-green-50 rounded-lg p-4"},G={class:"text-sm text-gray-600 space-y-1"},L={class:"mt-3"},R=["src"],_={__name:"ImageConverter",setup(_){const A=e(null),E=e(null),V=e(null),W=e(null),$=e(!1),J=e(!1),K=e("jpeg"),N=e(90),T=e(100),q=e=>{const a=e.target.files[0];a&&a.type.startsWith("image/")&&O(a)},H=e=>{$.value=!1;const a=e.dataTransfer.files[0];a&&a.type.startsWith("image/")&&O(a)},O=e=>{E.value=e;const a=new FileReader;a.onload=e=>{const a=new v;a.onload=()=>{V.value={src:e.target.result,width:a.width,height:a.height}},a.src=e.target.result},a.readAsDataURL(e)},Q=()=>{if(!V.value)return;J.value=!0;const e=document.createElement("canvas"),a=e.getContext("2d"),l=new v;l.onload=()=>{const t=Math.round(l.width*T.value/100),s=Math.round(l.height*T.value/100);e.width=t,e.height=s,a.drawImage(l,0,0,t,s);const r=S(K.value),o="jpeg"===K.value?N.value/100:void 0;e.toBlob(e=>{const a=new FileReader;a.onload=a=>{W.value={src:a.target.result,width:t,height:s,size:e.size},J.value=!1},a.readAsDataURL(e)},r,o)},l.src=V.value.src},S=e=>({jpeg:"image/jpeg",png:"image/png",webp:"image/webp",bmp:"image/bmp",gif:"image/gif"}[e]||"image/jpeg"),X=()=>{if(!W.value)return;const e="jpeg"===K.value?"jpg":K.value,a=document.createElement("a");a.download=`converted_${Date.now()}.${e}`,a.href=W.value.src,a.click()},Y=e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]};return(e,_)=>{return l(),a("div",m,[t("div",b,[t("div",y,[_[10]||(_[10]=t("h3",{class:"text-lg font-semibold text-gray-900"},"上传图片",-1)),t("div",{onDrop:H,onDragover:_[1]||(_[1]=o(()=>{},["prevent"])),onDragenter:_[2]||(_[2]=o(()=>{},["prevent"])),class:r(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors cursor-pointer",{"border-blue-500 bg-blue-50":$.value}])},[t("input",{ref_key:"fileInput",ref:A,type:"file",accept:"image/*",onChange:q,class:"hidden"},null,544),t("div",h,[t("div",f,[n(u(v),{class:"w-8 h-8 text-gray-400"})]),_[6]||(_[6]=t("div",null,[t("p",{class:"text-lg font-medium text-gray-900"},"拖拽图片到此处"),t("p",{class:"text-sm text-gray-500"},"或点击选择文件")],-1)),t("button",{onClick:_[0]||(_[0]=a=>e.$refs.fileInput.click()),class:"btn-primary"}," 选择图片 ")])],34),E.value?(l(),a("div",x,[_[9]||(_[9]=t("h4",{class:"font-medium text-gray-900"},"转换设置",-1)),t("div",w,[t("div",null,[_[8]||(_[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"目标格式",-1)),i(t("select",{"onUpdate:modelValue":_[3]||(_[3]=e=>K.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[..._[7]||(_[7]=[c('<option value="jpeg">JPEG</option><option value="png">PNG</option><option value="webp">WebP</option><option value="bmp">BMP</option><option value="gif">GIF</option>',5)])],512),[[d,K.value]])]),"jpeg"===K.value?(l(),a("div",k,[t("label",j,"质量 ("+p(N.value)+"%)",1),i(t("input",{"onUpdate:modelValue":_[4]||(_[4]=e=>N.value=e),type:"range",min:"10",max:"100",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,512),[[g,N.value]])])):s("",!0),t("div",null,[t("label",C,"缩放比例 ("+p(T.value)+"%)",1),i(t("input",{"onUpdate:modelValue":_[5]||(_[5]=e=>T.value=e),type:"range",min:"10",max:"200",step:"10",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,512),[[g,T.value]])])]),t("button",{onClick:Q,disabled:J.value,class:"btn-primary w-full"},p(J.value?"转换中...":"开始转换"),9,M)])):s("",!0)]),t("div",B,[_[13]||(_[13]=t("h3",{class:"text-lg font-semibold text-gray-900"},"转换结果",-1)),V.value?(l(),a("div",U,[t("div",D,[_[11]||(_[11]=t("h4",{class:"font-medium text-gray-900 mb-2"},"原图信息",-1)),t("div",I,[t("p",null,"文件名: "+p(E.value.name),1),t("p",null,"格式: "+p((O=E.value.name,O.split(".").pop().toLowerCase()).toUpperCase()),1),t("p",null,"大小: "+p(Y(E.value.size)),1),t("p",null,"尺寸: "+p(V.value.width)+" × "+p(V.value.height),1)]),t("div",z,[t("img",{src:V.value.src,class:"max-w-full h-auto rounded border"},null,8,F)])]),W.value?(l(),a("div",P,[_[12]||(_[12]=t("h4",{class:"font-medium text-gray-900 mb-2"},"转换后信息",-1)),t("div",G,[t("p",null,"格式: "+p(K.value.toUpperCase()),1),t("p",null,"大小: "+p(Y(W.value.size)),1),t("p",null,"尺寸: "+p(W.value.width)+" × "+p(W.value.height),1)]),t("div",L,[t("img",{src:W.value.src,class:"max-w-full h-auto rounded border"},null,8,R)]),t("div",{class:"mt-3 flex space-x-2"},[t("button",{onClick:X,class:"btn-primary flex-1"}," 下载转换图片 ")])])):s("",!0)])):s("",!0)])])]);var O}}};export{_ as default};

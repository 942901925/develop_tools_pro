import{r as e,c as l,k as t,l as a,m as s,n as r,z as o,A as n,t as c,I as u,J as d,F as i,q as g,p}from"./vendor-VsQ_eVXY.js";const m={class:"space-y-6"},v={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},b={class:"space-y-4"},x={key:0,class:"text-red-600 text-sm"},y={class:"space-y-4"},f={class:"w-full h-64 p-4 bg-gray-100 border border-gray-300 rounded-lg overflow-auto text-sm"},h={class:"bg-gray-50 p-6 rounded-lg"},S={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},O={class:"space-y-4"},j={class:"space-y-4"},k={class:"flex items-center"},J={class:"flex items-center"},N={class:"flex items-center"},w={class:"space-y-4"},A={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},U=["onClick"],V={class:"font-medium text-gray-900"},C={class:"text-sm text-gray-600 mt-1"},$={key:0,class:"space-y-4"},q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},G={class:"font-medium"},z={key:0,class:"mt-2 text-sm"},I={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},M={class:"bg-blue-50 p-4 rounded-lg text-center"},_={class:"text-2xl font-bold text-blue-600"},B={class:"bg-green-50 p-4 rounded-lg text-center"},F={class:"text-2xl font-bold text-green-600"},T={class:"bg-purple-50 p-4 rounded-lg text-center"},D={class:"text-2xl font-bold text-purple-600"},E={class:"bg-orange-50 p-4 rounded-lg text-center"},H={class:"text-2xl font-bold text-orange-600"},K={__name:"JsonSchemaGenerator",setup(K){const L=e(""),P=e(""),Q=e(""),R=e("Generated Schema"),W=e("Auto-generated JSON Schema"),X=e(!0),Y=e(!0),Z=e(!1),ee=e(""),le=e({valid:!0,errors:[]}),te=e([{name:"用户对象",description:"包含基本用户信息的对象",json:'{"id": 1, "name": "张三", "email": "zhang@example.com", "age": 25, "active": true}'},{name:"产品列表",description:"包含产品数组的对象",json:'{"products": [{"id": 1, "name": "商品A", "price": 99.99, "inStock": true}, {"id": 2, "name": "商品B", "price": 149.99, "inStock": false}], "total": 2}'},{name:"嵌套配置",description:"包含嵌套配置的对象",json:'{"database": {"host": "localhost", "port": 5432, "credentials": {"username": "admin", "password": "secret"}}, "cache": {"enabled": true, "ttl": 3600}}'}]),ae=l(()=>{try{const e=JSON.parse(L.value);return ce(e)}catch{return 0}}),se=l(()=>{try{const e=JSON.parse(L.value);return ue(e)}catch{return 0}}),re=()=>{try{const e=JSON.parse(L.value),l=oe(e);P.value=JSON.stringify(l,null,2),Q.value=""}catch(e){Q.value="JSON格式错误: "+e.message,P.value=""}},oe=(e,l="")=>{const t={$schema:"http://json-schema.org/draft-07/schema#",type:ne(e),title:R.value||"Generated Schema",description:W.value||"Auto-generated JSON Schema"};if(null===e)return{...t,type:"null"};if(Array.isArray(e))if(0===e.length)t.items={type:"string"};else{const a=e.map(e=>ne(e)),s=[...new Set(a)];1===s.length?t.items=oe(e[0],l+"[]"):t.items={oneOf:s.map(e=>({type:e}))}}else if("object"==typeof e){const a={},s=[];for(const[t,r]of Object.entries(e))a[t]=oe(r,l+"."+t),X.value&&null!=r&&s.push(t),Y.value&&(a[t].examples=[r]);t.properties=a,X.value&&s.length>0&&(t.required=s)}else Y.value&&(t.examples=[e]);return t},ne=e=>null===e?"null":Array.isArray(e)?"array":"object"==typeof e?"object":"string"==typeof e?"string":"number"==typeof e?Number.isInteger(e)?"integer":"number":"boolean"==typeof e?"boolean":"string",ce=e=>"object"!=typeof e||null===e?0:Array.isArray(e)?e.reduce((e,l)=>e+ce(l),0):Object.keys(e).length+Object.values(e).reduce((e,l)=>e+ce(l),0),ue=(e,l=0)=>"object"!=typeof e||null===e?l:Array.isArray(e)?Math.max(l,...e.map(e=>ue(e,l+1))):Math.max(l,...Object.values(e).map(e=>ue(e,l+1))),de=()=>{try{const e=JSON.parse(ee.value),l=JSON.parse(P.value),t=ie(e,l);le.value=t}catch(e){le.value={valid:!1,errors:["JSON格式错误: "+e.message]}}},ie=(e,l)=>{const t=[];if(l.type&&ne(e)!==l.type&&t.push(`期望类型 ${l.type}，实际类型 ${ne(e)}`),l.required&&"object"==typeof e&&null!==e)for(const a of l.required)a in e||t.push(`缺少必需字段: ${a}`);if(l.properties&&"object"==typeof e&&null!==e)for(const[a,s]of Object.entries(e))if(l.properties[a]){const e=ie(s,l.properties[a]);e.errors.length>0&&t.push(`字段 ${a}: ${e.errors.join(", ")}`)}return{valid:0===t.length,errors:t}},ge=()=>{L.value="",P.value="",Q.value="",ee.value="",le.value={valid:!0,errors:[]}},pe=async()=>{try{await navigator.clipboard.writeText(P.value)}catch(e){console.error("复制失败:",e)}};return(e,l)=>(a(),t("div",m,[s("div",v,[s("div",b,[s("div",{class:"flex items-center justify-between"},[l[7]||(l[7]=s("h3",{class:"text-lg font-semibold text-gray-900"},"JSON 数据",-1)),s("div",{class:"flex space-x-2"},[s("button",{onClick:re,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"}," 生成Schema "),s("button",{onClick:ge,class:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"}," 清空 ")])]),o(s("textarea",{"onUpdate:modelValue":l[0]||(l[0]=e=>L.value=e),placeholder:"请输入JSON数据...",class:"w-full h-64 p-4 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[n,L.value]]),Q.value?(a(),t("div",x,c(Q.value),1)):r("",!0)]),s("div",y,[s("div",{class:"flex items-center justify-between"},[l[8]||(l[8]=s("h3",{class:"text-lg font-semibold text-gray-900"},"JSON Schema",-1)),s("button",{onClick:pe,class:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors"}," 复制Schema ")]),s("pre",f,c(P.value),1)])]),s("div",h,[l[14]||(l[14]=s("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Schema 配置选项",-1)),s("div",S,[s("div",O,[s("div",null,[l[9]||(l[9]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Schema标题",-1)),o(s("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>R.value=e),placeholder:"输入Schema标题",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[n,R.value]])]),s("div",null,[l[10]||(l[10]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Schema描述",-1)),o(s("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>W.value=e),placeholder:"输入Schema描述",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[n,W.value]])])]),s("div",j,[s("div",null,[s("label",k,[o(s("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>X.value=e),type:"checkbox",class:"mr-2"},null,512),[[d,X.value]]),l[11]||(l[11]=u(" 包含required字段 ",-1))])]),s("div",null,[s("label",J,[o(s("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>Y.value=e),type:"checkbox",class:"mr-2"},null,512),[[d,Y.value]]),l[12]||(l[12]=u(" 包含示例值 ",-1))])]),s("div",null,[s("label",N,[o(s("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>Z.value=e),type:"checkbox",class:"mr-2"},null,512),[[d,Z.value]]),l[13]||(l[13]=u(" 严格模式 ",-1))])])])])]),s("div",w,[l[15]||(l[15]=s("h3",{class:"text-lg font-semibold text-gray-900"},"示例数据",-1)),s("div",A,[(a(!0),t(i,null,g(te.value,e=>(a(),t("div",{key:e.name,class:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:l=>(e=>{L.value=e.json,re()})(e)},[s("div",V,c(e.name),1),s("div",C,c(e.description),1)],8,U))),128))])]),P.value?(a(),t("div",$,[l[18]||(l[18]=s("h3",{class:"text-lg font-semibold text-gray-900"},"Schema验证",-1)),s("div",q,[s("div",null,[l[16]||(l[16]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"测试JSON数据",-1)),o(s("textarea",{"onUpdate:modelValue":l[6]||(l[6]=e=>ee.value=e),placeholder:"输入要验证的JSON数据...",class:"w-full h-32 p-4 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-green-500 focus:border-green-500"},null,512),[[n,ee.value]]),s("button",{onClick:de,class:"mt-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"}," 验证JSON ")]),s("div",null,[l[17]||(l[17]=s("div",{class:"text-sm font-medium text-gray-700 mb-2"},"验证结果",-1)),s("div",{class:p(["p-4 rounded-lg",le.value.valid?"bg-green-50 text-green-800":"bg-red-50 text-red-800"])},[s("div",G,c(le.value.valid?"✓ 验证通过":"✗ 验证失败"),1),le.value.errors.length>0?(a(),t("div",z,[(a(!0),t(i,null,g(le.value.errors,e=>(a(),t("div",{key:e,class:"mb-1"}," • "+c(e),1))),128))])):r("",!0)],2)])])])):r("",!0),s("div",I,[s("div",M,[s("div",_,c(L.value.length),1),l[19]||(l[19]=s("div",{class:"text-sm text-gray-600"},"JSON字符数",-1))]),s("div",B,[s("div",F,c(P.value.length),1),l[20]||(l[20]=s("div",{class:"text-sm text-gray-600"},"Schema字符数",-1))]),s("div",T,[s("div",D,c(ae.value),1),l[21]||(l[21]=s("div",{class:"text-sm text-gray-600"},"属性数量",-1))]),s("div",E,[s("div",H,c(se.value),1),l[22]||(l[22]=s("div",{class:"text-sm text-gray-600"},"嵌套层级",-1))])])]))}};export{K as default};

import{r as e,c as a,k as l,l as t,m as s,n as r,p as n,R as u,j as o,u as i,C as d,t as c,D as v}from"./vendor-Cf-Dxv3i.js";import{I as g}from"./ui-D-c3Ifvx.js";const m={class:"space-y-6"},p={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},h={class:"space-y-4"},y={class:"space-y-4"},b={class:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center"},x={key:0,class:"space-y-4"},f={class:"space-y-3"},w={class:"block text-sm font-medium text-gray-700 mb-1"},k={class:"block text-sm font-medium text-gray-700 mb-1"},M={class:"block text-sm font-medium text-gray-700 mb-1"},C=["disabled"],z={class:"space-y-4"},B={key:0,class:"space-y-4"},D={class:"bg-gray-50 rounded-lg p-4"},j={class:"text-sm text-gray-600 space-y-1"},I={class:"mt-3"},R=["src"],U={key:0,class:"bg-green-50 rounded-lg p-4"},F={class:"text-sm text-gray-600 space-y-1"},_={class:"mt-3"},V=["src"],A={__name:"ImageCompressor",setup(A){const E=e(null),L=e(null),W=e(null),$=e(null),G=e(!1),K=e(!1),T=e(80),q=e(800),H=e(600),J=e=>{const a=e.target.files[0];a&&a.type.startsWith("image/")&&O(a)},N=e=>{G.value=!1;const a=e.dataTransfer.files[0];a&&a.type.startsWith("image/")&&O(a)},O=e=>{L.value=e;const a=new FileReader;a.onload=e=>{const a=new g;a.onload=()=>{W.value={src:e.target.result,width:a.width,height:a.height}},a.src=e.target.result},a.readAsDataURL(e)},P=()=>{if(!W.value)return;K.value=!0;const e=document.createElement("canvas"),a=e.getContext("2d"),l=new g;l.onload=()=>{let{width:t,height:s}=Q(l.width,l.height);e.width=t,e.height=s,a.drawImage(l,0,0,t,s),e.toBlob(e=>{const a=new FileReader;a.onload=a=>{$.value={src:a.target.result,width:t,height:s,size:e.size},K.value=!1},a.readAsDataURL(e)},"image/jpeg",T.value/100)},l.src=W.value.src},Q=(e,a)=>{let l=e,t=a;return l>q.value&&(t=t*q.value/l,l=q.value),t>H.value&&(l=l*H.value/t,t=H.value),{width:Math.round(l),height:Math.round(t)}},S=()=>{if(!$.value)return;const e=document.createElement("a");e.download=`compressed_${L.value.name}`,e.href=$.value.src,e.click()},X=e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},Y=a(()=>W.value&&$.value?Math.round(100*(1-$.value.size/L.value.size)):0);return(e,a)=>(t(),l("div",m,[s("div",p,[s("div",h,[a[8]||(a[8]=s("h3",{class:"text-lg font-semibold text-gray-900"},"上传图片",-1)),s("div",{onDrop:N,onDragover:a[1]||(a[1]=u(()=>{},["prevent"])),onDragenter:a[2]||(a[2]=u(()=>{},["prevent"])),class:n(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors cursor-pointer",{"border-blue-500 bg-blue-50":G.value}])},[s("input",{ref_key:"fileInput",ref:E,type:"file",accept:"image/*",onChange:J,class:"hidden"},null,544),s("div",y,[s("div",b,[o(i(g),{class:"w-8 h-8 text-gray-400"})]),a[6]||(a[6]=s("div",null,[s("p",{class:"text-lg font-medium text-gray-900"},"拖拽图片到此处"),s("p",{class:"text-sm text-gray-500"},"或点击选择文件")],-1)),s("button",{onClick:a[0]||(a[0]=a=>e.$refs.fileInput.click()),class:"btn-primary"}," 选择图片 ")])],34),L.value?(t(),l("div",x,[a[7]||(a[7]=s("h4",{class:"font-medium text-gray-900"},"压缩设置",-1)),s("div",f,[s("div",null,[s("label",w,"质量 ("+c(T.value)+"%)",1),d(s("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>T.value=e),type:"range",min:"10",max:"100",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,512),[[v,T.value]])]),s("div",null,[s("label",k,"最大宽度 ("+c(q.value)+"px)",1),d(s("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>q.value=e),type:"range",min:"100",max:"2000",step:"50",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,512),[[v,q.value]])]),s("div",null,[s("label",M,"最大高度 ("+c(H.value)+"px)",1),d(s("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>H.value=e),type:"range",min:"100",max:"2000",step:"50",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,512),[[v,H.value]])])]),s("button",{onClick:P,disabled:K.value,class:"btn-primary w-full"},c(K.value?"压缩中...":"开始压缩"),9,C)])):r("",!0)]),s("div",z,[a[11]||(a[11]=s("h3",{class:"text-lg font-semibold text-gray-900"},"预览结果",-1)),W.value?(t(),l("div",B,[s("div",D,[a[9]||(a[9]=s("h4",{class:"font-medium text-gray-900 mb-2"},"原图信息",-1)),s("div",j,[s("p",null,"文件名: "+c(L.value.name),1),s("p",null,"大小: "+c(X(L.value.size)),1),s("p",null,"尺寸: "+c(W.value.width)+" × "+c(W.value.height),1)]),s("div",I,[s("img",{src:W.value.src,class:"max-w-full h-auto rounded border"},null,8,R)])]),$.value?(t(),l("div",U,[a[10]||(a[10]=s("h4",{class:"font-medium text-gray-900 mb-2"},"压缩后信息",-1)),s("div",F,[s("p",null,"大小: "+c(X($.value.size)),1),s("p",null,"尺寸: "+c($.value.width)+" × "+c($.value.height),1),s("p",null,"压缩率: "+c(Y.value)+"%",1)]),s("div",_,[s("img",{src:$.value.src,class:"max-w-full h-auto rounded border"},null,8,V)]),s("div",{class:"mt-3 flex space-x-2"},[s("button",{onClick:S,class:"btn-primary flex-1"}," 下载压缩图片 ")])])):r("",!0)])):r("",!0)])])]))}};export{A as default};
